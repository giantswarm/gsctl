machine:
  services:
    - docker

dependencies:
  override:
    # install kubectl
    - wget https://storage.googleapis.com/kubernetes-release/release/v1.6.7/bin/linux/amd64/kubectl
    - chmod +x kubectl
    - sudo mv kubectl /usr/local/bin/kubectl
    # install glide
    - sudo add-apt-repository -y ppa:masterminds/glide
    - sudo apt-get update -q
    - sudo apt-get install -y glide

test:
  pre:
    # make dependencies avalable in $GOPATH
    - cp -r ./vendor/* /home/ubuntu/.go_workspace/src/
  override:
    - make gotest
    - make build
    - make test
    - ./test_coverage.sh
  post:
    - bash <(curl -s https://codecov.io/bash)
