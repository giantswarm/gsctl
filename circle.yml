machine:
  services:
    - docker
  environment:
    GOPATH: "${HOME}/gsctl:${HOME}/gsctl/vendor"

dependencies:
  override:
    # install architect
    - |
      wget -q $(curl -sS -H "Authorization: token $RELEASE_TOKEN" https://api.github.com/repos/giantswarm/architect/releases/latest | grep browser_download_url | head -n 1 | cut -d '"' -f 4)
    - chmod +x ./architect
    - ./architect version
    # install kubectl
    - wget https://storage.googleapis.com/kubernetes-release/release/v1.6.7/bin/linux/amd64/kubectl
    - chmod +x kubectl
    - sudo mv kubectl /usr/local/bin/kubectl
    # install glide
    #- sudo add-apt-repository -y ppa:masterminds/glide
    #- sudo apt-get update -q
    #- sudo apt-get install -y glide

test:
  override:
    - make crosscompile
  post:
    - bash <(curl -s https://codecov.io/bash)
